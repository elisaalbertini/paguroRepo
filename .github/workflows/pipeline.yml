
name: Main project workflow

on: 
    push:
        branches:
            - main
        paths-ignore:
            - 'README.md'
            - 'CHANGELOG.md'
            - 'LICENSE'
jobs:
    test:
        strategy:
          matrix:
            java-version: [ 18 ]
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v4
            - uses: actions/setup-java@v4
              with:
                  distribution: "temurin"
                  java-version: ${{ matrix.java-version }}
            - uses: ./gradlew test
    release:
        needs: test
        runs-on: ubuntu-latest
        concurrency:
          group: release
          cancel-in-progress: false
        steps:
          #- name: Checkout
           # uses: actions/checkout@v4
          - uses: actions/setup-node@v4
            with:
                 node-version: '>=20.10.0'
          - name: Release
            env: 
              GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
            run: |
              npm install
              npx semantic-release
            id: ver
        outputs:
          newVersion: ${{ steps.ver.outputs.nextVer }}
